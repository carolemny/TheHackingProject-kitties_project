<p id="notice"><%= notice %></p>

<h2>Panier</h2>
  <% if flash[:notice] %>
    <div class="notice"><%= flash[:notice] %></div>
  <% end %>
<ul>

<div class="container">
	<table id="cart" class="table table-hover table-condensed">
    				<thead>
						<tr>
							<th style="width:80%"></th>
							<th style="width:10%">Prix</th>
							<th style="width:8%">Quantité</th>
							<th style="width:22%" class="text-center">Total</th>
							<th style="width:10%"></th>
						</tr>
					</thead>
					<tbody>
						<tr>
	 <% @cart.join_item_carts.sort_by(&:id).each do |join_item_cart| %>
							<td data-th="Product">
								<div class="row">
									<div class="col-sm-2 hidden-xs"><img src="http://placehold.it/100x100" alt="..." class="img-responsive"/></div>
									<div class="col-sm-10">
										<h4 class="nomargin"><%= "#{join_item_cart.item.title}" %></h4>
										<p><%= join_item_cart.item.description %></p>
									</div>
								</div>
							</td>
							<td data-th="Price"><%= join_item_cart.item.price %> €</td>
							<td data-th="Quantity">
							<%= "#{join_item_cart.quantity}" %>
							</td>
							<td data-th="Subtotal" class="text-center"><%= join_item_cart.total_item %> €</td>
							<td class="actions" data-th="">
							<div class="d-flex  align-items-center">
								<%= button_to "+", join_item_carts_path(item_id: join_item_cart.item), class: "btn btn-success " %>
								<%= button_to "-", join_item_cart_path(join_item_cart.id), method: :put, class: "btn btn-warning m-2" %>	
							</div>
								<%= link_to "supprimer", join_item_cart_path(id: join_item_cart.id), method: :delete, class: "btn btn-danger" %>							
							</td>
						</tr>
					</tbody>
					 <% end %>
					<tfoot>
						
						<tr>
							<td><%= link_to "Retour aux produits", root_path, class: "btn btn-warning" %></td>
							<td colspan="2" class="hidden-xs"></td>
							<td class="hidden-xs text-center"><strong><%= @cart.total_cart %> €</strong></td>
							<td>
							<% if user_signed_in? %>
							<%= form_tag carts_path do %>
								<script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
   								data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
   								data-description="Payez votre commande"
   								data-email=<%= current_user.email %>
   								data-currency= 'eur',
   								data-amount=<%=  @cart.total_cart * 100 %>
   								data-locale="auto">
 								</script>
							<% end %>
							<% else %>
									<%= link_to "Se connecter", new_user_session_path, class:"btn btn-success btn-block" %>
							<% end %>
							</td>
						</tr>
					</tfoot>
				</table>

	<% if flash[:error].present? %>
    <div id="error_explanation">
      <p><%= flash[:error] %></p>
    </div>
  <% end %>
</div>